<template>
  <div style="position: relative;">
    <template if:true={loaded}>
        <div class="loader_container">
            <span class="loader"></span>
        </div> 
    </template>
    <div class="container">
        <div class="sidebar">
            <h1 style="margin-left: 10px;display: flex;justify-content: center;"><svg width="200" height="42" viewBox="0 0 396 42" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_51_5)">
                        <g clip-path="url(#clip1_51_5)">
                            <path
                                d="M335.908 10.3163C335.908 8.13186 335.32 6.36106 334.594 6.36106C333.869 6.36106 333.281 8.13186 333.281 10.3163V31.6838C333.281 33.8682 333.869 35.639 334.594 35.639C335.32 35.639 335.908 33.8682 335.908 31.6838V10.3163Z"
                                fill="#085F63" />
                            <g clip-path="url(#clip2_51_5)">
                                <g clip-path="url(#clip3_51_5)">
                                    <g clip-path="url(#clip4_51_5)">
                                        <g clip-path="url(#clip5_51_5)">
                                            <path
                                                d="M6.50736 7.22125L16.3887 31.4325H16.7824L26.6637 7.22125H32.5296L21.3097 34.7788H11.8614L0.641541 7.22125H6.50736ZM41.3873 7.22125V34.7788H35.679V7.22125H41.3873ZM46.8989 7.22125H59.8903C62.2523 7.22125 64.3966 7.5152 66.323 8.10309C68.2494 8.69623 69.9028 9.5702 71.2833 10.725C72.6586 11.8798 73.7294 13.3154 74.4958 15.0318C75.2569 16.7535 75.6374 18.7429 75.6374 21C75.6374 23.2571 75.2569 25.2439 74.4958 26.9603C73.7294 28.682 72.6586 30.1203 71.2833 31.2751C69.9028 32.4298 68.2494 33.3012 66.323 33.8891C64.3966 34.4822 62.2523 34.7788 59.8903 34.7788H46.8989V7.22125ZM59.8903 10.1738H52.6072V31.8262H59.8903C61.2288 31.8262 62.4807 31.6215 63.646 31.2121C64.8165 30.8079 65.8348 30.1649 66.7009 29.283C67.567 28.4064 68.2546 27.2858 68.7638 25.921C69.2782 24.5563 69.5354 22.9159 69.5354 21C69.5354 19.0841 69.2782 17.4438 68.7638 16.079C68.2546 14.7143 67.567 13.591 66.7009 12.7091C65.8348 11.8325 64.8165 11.1895 63.646 10.7801C62.4807 10.3759 61.2288 10.1738 59.8903 10.1738ZM103.974 10.1738H85.6684V19.2285H100.038V22.1811H85.6684V31.8262H103.974V34.7788H79.96V7.22125H103.974V10.1738ZM122.871 9.18965C121.533 9.18965 120.281 9.42585 119.115 9.89827C117.945 10.3707 116.927 11.0924 116.06 12.0635C115.194 13.0346 114.507 14.2602 113.998 15.7405C113.483 17.226 113.226 18.9791 113.226 21C113.226 23.0209 113.483 24.7715 113.998 26.2517C114.507 27.7372 115.194 28.9655 116.06 29.9365C116.927 30.9076 117.945 31.6294 119.115 32.1018C120.281 32.5742 121.533 32.8104 122.871 32.8104C124.21 32.8104 125.464 32.5742 126.635 32.1018C127.8 31.6294 128.816 30.9076 129.682 29.9365C130.548 28.9655 131.238 27.7372 131.752 26.2517C132.262 24.7715 132.516 23.0209 132.516 21C132.516 18.9791 132.262 17.226 131.752 15.7405C131.238 14.2602 130.548 13.0346 129.682 12.0635C128.816 11.0924 127.8 10.3707 126.635 9.89827C125.464 9.42585 124.21 9.18965 122.871 9.18965ZM122.871 6.43389C125.233 6.43389 127.38 6.74884 129.312 7.37872C131.238 8.00861 132.892 8.94032 134.272 10.1738C135.647 11.4074 136.715 12.9296 137.477 14.7405C138.238 16.5514 138.618 18.6379 138.618 21C138.618 23.3621 138.238 25.4486 137.477 27.2595C136.715 29.0704 135.647 30.5927 134.272 31.8262C132.892 33.0597 131.238 33.9914 129.312 34.6213C127.38 35.2512 125.233 35.5662 122.871 35.5662C120.509 35.5662 118.357 35.2512 116.415 34.6213C114.473 33.9914 112.814 33.0597 111.439 31.8262C110.058 30.5927 108.995 29.0704 108.25 27.2595C107.499 25.4486 107.124 23.3621 107.124 21C107.124 18.6379 107.499 16.5514 108.25 14.7405C108.995 12.9296 110.058 11.4074 111.439 10.1738C112.814 8.94032 114.473 8.00861 116.415 7.37872C118.357 6.74884 120.509 6.43389 122.871 6.43389Z"
                                                fill="#085F63" />
                                            <path
                                                d="M170.9 32.6136C172.685 32.6136 174.396 32.3039 176.034 31.6845C177.676 31.0703 179.246 30.0678 180.742 28.6768L182.71 31.0388C181.214 32.4298 179.403 33.5321 177.278 34.3457C175.152 35.1594 172.895 35.5662 170.506 35.5662C168.039 35.5662 165.814 35.2512 163.829 34.6213C161.851 33.9914 160.158 33.0597 158.751 31.8262C157.35 30.5927 156.268 29.0704 155.507 27.2595C154.746 25.4486 154.365 23.3621 154.365 21C154.365 18.6379 154.738 16.5514 155.483 14.7405C156.234 12.9296 157.297 11.4074 158.672 10.1738C160.053 8.94032 161.714 8.00861 163.656 7.37872C165.598 6.74884 167.751 6.43389 170.113 6.43389C172.501 6.43389 174.758 6.84069 176.884 7.6543C179.01 8.4679 180.821 9.5702 182.317 10.9612L180.348 13.3233C178.852 11.9323 177.283 10.9271 175.64 10.3077C174.002 9.69356 172.291 9.38649 170.506 9.38649C169.089 9.38649 167.764 9.61482 166.53 10.0715C165.297 10.5334 164.234 11.2368 163.341 12.1816C162.449 13.1264 161.746 14.3258 161.231 15.7798C160.722 17.2391 160.467 18.9791 160.467 21C160.467 23.0209 160.722 24.7583 161.231 26.2123C161.746 27.6716 162.467 28.8736 163.396 29.8184C164.331 30.7633 165.433 31.464 166.703 31.9207C167.979 32.3826 169.378 32.6136 170.9 32.6136ZM199.442 10.5675L193.537 25.1337H205.741L199.835 10.5675H199.442ZM195.111 7.22125H204.166L215.386 34.7788H209.717L207.118 28.0862H192.159L189.56 34.7788H183.891L195.111 7.22125ZM224.236 31.8262H241.164V34.7788H218.527V7.22125H224.236V31.8262ZM250.415 31.8262H267.343V34.7788H244.707V7.22125H250.415V31.8262ZM294.901 10.1738H276.595V19.2285H290.964V22.1811H276.595V31.8262H294.901V34.7788H270.887V7.22125H294.901V10.1738ZM298.838 7.22125H313.01C314.979 7.22125 316.742 7.43646 318.301 7.86688C319.866 8.30256 321.186 8.93244 322.262 9.75654C323.338 10.5859 324.165 11.5963 324.742 12.7879C325.319 13.9847 325.608 15.3442 325.608 16.8664C325.608 18.966 325.083 20.7376 324.033 22.1811C322.983 23.6246 321.474 24.7269 319.506 25.488L326.002 34.7788H319.506L313.719 26.5115H313.01H304.546V34.7788H298.838V7.22125ZM313.01 10.1738H304.546V23.5589H313.01C315.084 23.5589 316.685 23.0157 317.813 21.9291C318.942 20.8373 319.506 19.1497 319.506 16.8664C319.506 14.5831 318.942 12.8955 317.813 11.8037C316.685 10.7171 315.084 10.1738 313.01 10.1738Z"
                                                fill="#49BEB7" />
                                        </g>
                                    </g>
                                </g>
                            </g>
                            <g clip-path="url(#clip6_51_5)">
                                <g clip-path="url(#clip7_51_5)">
                                    <path
                                        d="M369.124 12.5733C364.376 12.5733 360.526 16.4235 360.526 21.1717C360.526 25.9198 364.376 29.77 369.124 29.77C373.872 29.77 377.723 25.9198 377.723 21.1717C377.723 16.4235 373.873 12.5733 369.124 12.5733ZM366.159 26.5385V15.8048L373.671 21.1717L366.159 26.5385Z"
                                        fill="#49BEB7" />
                                    <path
                                        d="M395.76 37.9678C395.76 39.7144 394.344 41.1304 392.597 41.1304H345.948C344.201 41.1304 342.785 39.7144 342.785 37.9678V4.03222C342.785 2.28564 344.201 0.869629 345.948 0.869629H392.597C394.344 0.869629 395.76 2.28564 395.76 4.03222V37.9678ZM345.434 3.51837V37.9519H392.6L392.597 3.51837H345.434Z"
                                        fill="#49BEB7" />
                                </g>
                            </g>
                        </g>
                    </g>
                    <defs>
                        <clipPath id="clip0_51_5">
                            <rect width="395.52" height="40.2608" fill="white"
                                transform="translate(0.23999 0.869629)" />
                        </clipPath>
                        <clipPath id="clip1_51_5">
                            <rect width="395.52" height="40.2608" fill="white"
                                transform="translate(0.23999 0.869629)" />
                        </clipPath>
                        <clipPath id="clip2_51_5">
                            <rect width="326.163" height="29.1323" fill="white"
                                transform="translate(0.23999 6.43389)" />
                        </clipPath>
                        <clipPath id="clip3_51_5">
                            <rect width="326.163" height="29.1323" fill="white"
                                transform="translate(0.23999 6.43389)" />
                        </clipPath>
                        <clipPath id="clip4_51_5">
                            <rect width="326.163" height="29.1323" fill="white"
                                transform="translate(0.23999 6.43389)" />
                        </clipPath>
                        <clipPath id="clip5_51_5">
                            <rect width="326.163" height="29.1323" fill="white"
                                transform="translate(0.23999 6.43389)" />
                        </clipPath>
                        <clipPath id="clip6_51_5">
                            <rect width="52.9747" height="40.2608" fill="white"
                                transform="translate(342.785 0.869629)" />
                        </clipPath>
                        <clipPath id="clip7_51_5">
                            <rect width="52.9747" height="40.2608" fill="white"
                                transform="translate(342.785 0.869629)" />
                        </clipPath>
                    </defs>
                </svg>
            </h1>
            <div style="margin: 10px;">
                <lightning-input type="text" placeholder="Search User" variant="label-hidden" onchange={searchUser}
                    class="search_input"> </lightning-input>
            </div>
            <div class="sidebar_userList">
                <template if:true={searchUserFlag}>
                    <template for:each={userData} for:item="user">
                        <div class="usertitle" key={user} data-key={user.Id} onclick={getUserDetail}>
                            <lightning-avatar initials={user.Initial} fallback-icon-name="standard:avatar"
                                alternative-text="Bob Wilson" class="slds-m-right_small avter"></lightning-avatar>

                            <div class="user_name">
                                {user.FirstName} {user.LastName}
                            </div>
                        </div>
                    </template>
                </template>
                <template if:false={searchUserFlag}>
                    <div
                        style="display: flex; justify-content: center; align-items: center; width: 100%; height: 100%;">
                        Not found User.
                    </div>
                </template>
            </div>
        </div>
        <div class="main">
            <template if:false={activeUserFlag}>
                <div class="main_header">
                    <div class="toast toast--green" if:true={toastflag}>
                        <lightning-icon icon-name='utility:user' alternative-text='user' size='small'
                        title='user' class="user_icon"></lightning-icon>
                        <div class="toast__content">
                            <p class="toast__message">{activeUser.FirstName} {activeUser.LastName}</p>
                        </div>
                        <div class="toast__button callReceive" onclick={callAccept} if:true={recjectIconFlag}>
                            <img src={phoneImage} />
                        </div>
                        <div class="toast__button callReject"  if:true={recjectIconFlag}  onclick={callReject}>
                            <img src={phoneImage} />
                        </div>
                        <div class="toast__button callReject" data-id="1" if:false={recjectIconFlag}  onclick={callReject}>
                            <img src={phoneImage} />
                        </div>
                    </div>
                    <div class="toast toast--red" if:true={cancelFlag}>
                        <lightning-icon icon-name='utility:user' alternative-text='user' size='small'
                        title='user' class="user_icon"></lightning-icon>
                        <div class="toast__content">
                            <p class="toast__message">Call Reject</p>
                        </div>
                        <div class="toast__button " onclick={callClose} if:true={recjectIconFlag}>
                            <lightning-icon icon-name='utility:close' alternative-text='close' size='medium' title='close'></lightning-icon>
                        </div>
                    </div>
                    <div style="display: flex;align-items: center;" >
                        <div class="header_back" onclick={goToBack}>
                            <lightning-icon icon-name='utility:back' alternative-text='back' size='small'
                                title='back'></lightning-icon>
                        </div>
                        <div class="header_main">
                            <div class="usertitle">
                                <lightning-icon icon-name='utility:user' alternative-text='user' size='small'
                                    title='user' class="user_icon"></lightning-icon>
                               <div> <p style="  width: 99px;text-overflow: ellipsis;overflow: hidden;">
                                    {activeUser.FirstName} {activeUser.LastName}
                                </p>
                               </div>
                            </div>
                        </div>
                    </div>
                    <div  onclick={callCammera}>
                        <lightning-icon icon-name="action:call" size="small" alternative-text="call"
                            class="slds-m-left_xx-small"></lightning-icon>
                    </div>

                </div>
                <div class="main_container">
                    <c-callercmp  activeuser={activeUser}  onconnectcall={connectCallHandler}></c-callercmp>
                </div>
            </template>
        </div>
    </div>
</div>
</template>